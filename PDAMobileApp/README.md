# ü§´ Hushh PDA Hackathon - Personal Data Agent System

Welcome to our **consent-native Personal Data Agent (PDA) system** built for the Hushh AI Hackathon. This project demonstrates the future of privacy-first AI with two intelligent agents working together.

## üèÜ What We Built

### **üì• Inbox Agent (Email Intelligence)**
- **Gmail Integration:** Secure OAuth2 connection with consent-validated access
- **AI-Powered Analysis:** Automatically analyzes emails for summaries, action items, key topics, and sentiment
- **Smart Content Generation:** Creates professional replies, proposals, and responses using AI
- **Batch Processing:** Select multiple emails for bulk analysis and categorization

### **üìÖ Schedule Agent (Calendar Intelligence)**  
- **Google Calendar Integration:** Secure OAuth2 connection with encrypted token storage
- **AI-Powered Scheduling:** Suggests optimal meeting times based on learned patterns
- **Smart Event Creation:** AI can auto-schedule events with confidence scoring
- **Pattern Learning:** Analyzes your scheduling habits and preferences

### **üì± Mobile-First Experience**
- **React Native App:** Beautiful, modern interface for both agents
- **Real-time Sync:** Pull-to-refresh and live updates
- **Consent Management:** Clear visibility into what data is being accessed
- **Cross-Agent Communication:** Agents can work together (email ‚Üí calendar events)

## üöÄ Quick Start

### Prerequisites
- Python 3.9+
- Node.js 16+
- React-native CLI
- Google Cloud Console account (for OAuth credentials)

### 1. Clone the Repository
```bash
git clone [YOUR_REPO_URL]
cd PDAMobileApp
```

### 2. Backend Setup (consent-protocol/)

```bash
cd consent-protocol

# Install Python dependencies
pip install -r requirements.txt

# Set up environment variables
cp .env
# Edit .env with your API keys (see Configuration section below)

# Run the unified agent server
python run_unified_agent.py
```

The backend will start on `http://localhost:8000` with endpoints:
- `/inbox-agent/*` - Email intelligence endpoints
- `/schedule-agent/*` - Calendar management endpoints

### 3. Mobile App Setup

```bash
# Install Node.js dependencies
npm install

# Start the react-native development server
npx react-native run-android
```

### 4. Configuration

Create a `.env` file in the `consent-protocol/` directory:

```env
# Google OAuth Credentials
GOOGLE_CLIENT_ID=your_gmail_client_id
GOOGLE_CLIENT_SECRET=your_gmail_client_secret
GOOGLE_CALENDAR_CLIENT_ID=your_calendar_client_id
GOOGLE_CALENDAR_CLIENT_SECRET=your_calendar_client_secret

# OpenAI API
OPENAI_API_KEY=your_openai_api_key

# Backend Configuration
BACKEND_URL=https://your-ngrok-url.ngrok-free.app
AGENT_MASTER_KEY=your_encryption_key

# Optional: Google Calendar Tokens (for demo)
GOOGLE_CALENDAR_TOKEN=your_calendar_token
GOOGLE_CALENDAR_REFRESH_TOKEN=your_refresh_token
```

### 5. Google Cloud Console Setup

1. **Create a Google Cloud Project**
2. **Enable Gmail API and Google Calendar API**
3. **Create OAuth 2.0 credentials** for both Gmail and Calendar
4. **Add authorized redirect URIs:**
   - `https://your-ngrok-url.ngrok-free.app/inbox-agent/auth/gmail/callback`
   - `https://your-ngrok-url.ngrok-free.app/schedule-agent/auth/google/callback`

## üîß Key Features & Usage

### **Consent-Native Architecture**

Every action requires cryptographically signed consent tokens:

```python
# Token validation on every API call
valid, reason, token = validate_token(token_str, ConsentScope.GMAIL_READ)
if not valid:
    raise HTTPException(status_code=403, detail=f"Consent validation failed: {reason}")
```

### **AI-Powered Features**

#### **Email Intelligence (Inbox Agent)**
```bash
# Get AI analysis of emails
curl -X POST "https://your-backend/inbox-agent/analyze" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "your_consent_token",
    "user_id": "user_123",
    "email_ids": ["email1", "email2"],
    "analysis_type": "summary"
  }'
```

#### **Smart Scheduling (Schedule Agent)**
```bash
# Get AI meeting time suggestions
curl -X POST "https://your-backend/schedule-agent/suggest-meeting" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "your_consent_token", 
    "user_id": "user_123",
    "duration": 60,
    "participants": ["user@example.com"]
  }'
```

### **Mobile App Features**

#### **Calendar Screen**
- **Connect Google Calendar** via OAuth2
- **View Events** from both local and Google calendars
- **Create Events** with smart AI suggestions or manual selection
- **AI Insights** showing learned preferences and patterns

#### **Gmail Screen**
- **Connect Gmail** via OAuth2
- **Browse Inbox** with infinite scrolling
- **AI Analysis** of email content and sentiment
- **Smart Replies** generated by AI
- **Batch Operations** for multiple emails

## üîê Security & Privacy

### **Encryption**
All sensitive data is encrypted using AES-256-GCM:

```python
# Encrypt OAuth tokens before storage
encrypted = encrypt_data(json.dumps(token_data), AGENT_MASTER_KEY)
user_token_store[user_id] = encrypted
```

### **Consent Validation**
Every API call validates consent tokens:

```python
# Validate scope and expiration
valid, reason, token = validate_token(token_str, expected_scope)
if not valid or token.user_id != user_id:
    raise HTTPException(status_code=403, detail="Invalid consent")
```

### **Privacy Features**
- **No plaintext storage** of OAuth tokens
- **Scope-limited access** (read vs write permissions)
- **User-controlled revocation** of permissions
- **No data retention** beyond active sessions

## üß™ Testing

### **Run Backend Tests**
```bash
cd consent-protocol
python -m pytest tests/ -v
```

### **Test Consent Flow**
```bash
python demo_consent_flow.py
```

### **Test Agent Communication**
```bash
python test_agent_communication.py
```


## üöÄ Deployment

### **Backend Deployment**
1. **Set up ngrok** for development tunneling:
   ```bash
   ngrok http 8000
   ```

2. **Update BACKEND_URL** in your `.env` file with the ngrok URL

3. **Run the server**:
   ```bash
   python run_unified_agent.py
   ```


## üîß Troubleshooting

### **Common Issues**

1. **OAuth Flow Fails**
   - Check that redirect URIs are correctly configured in Google Cloud Console
   - Ensure ngrok URL is accessible and HTTPS

2. **Consent Token Errors**
   - Verify that tokens are being issued correctly
   - Check that scopes match expected permissions

3. **Mobile App Connection Issues**
   - Ensure backend URL is correctly set in mobile app
   - Check that ngrok tunnel is active

### **Debug Mode**
Enable debug logging:
```bash
export LOG_LEVEL=DEBUG
python run_unified_agent.py
```

## üìä Hackathon Compliance

‚úÖ **Consent-Native** - Every action gated by signed, scoped consent tokens  
‚úÖ **Privacy-Preserving** - AES-256-GCM encryption for all sensitive data  
‚úÖ **Modular & Extensible** - Independent agents with clear manifests  
‚úÖ **Mobile-First** - React Native app with real-world consent flows  
‚úÖ **AI-Powered** - LLM integration for intelligent features  
‚úÖ **Testable** - Comprehensive test suite for all components  
‚úÖ **Real-World Useful** - Solves actual problems (email management, scheduling)  

## ü§ù Contributing

This project was built for the Hushh PDA Hackathon. The architecture is designed to be:

- **Modular** - Easy to add new agents
- **Extensible** - Clear interfaces for new features
- **Forkable** - Other teams can build on this foundation

## üìû Support

For questions about this submission:
- **Email:** [Your Email]
- **GitHub Issues:** [Your Repo Issues]

---

**Built with ‚ù§Ô∏è for the Hushh AI Personal Data Agent Challenge 2024**
